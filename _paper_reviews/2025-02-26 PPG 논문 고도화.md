---
layout: post
title: "PPG 논문 고도화"
date: 2025-02-26
typora-root-url: ../
image_style: "max-width:80%; display:block; margin:1em auto; border-radius:10px; box-shadow:0px 4px 8px rgba(0,0,0,0.8);"
---

**Pulse-PPG: 실험실 및 현장 설정 전반의 웨어러블 애플리케이션을 위한 오픈 소스 현장 훈련 PPG 기반 모델**

https://arxiv.org/html/2502.01108v1#S4 **- 2025년 2월 3일 - 코드 없음**

- 논문은 광용적맥파(PPG) 기반의 오픈소스 기초 모델인 Pulse-PPG을 제안
- 특히 실험실과 현장 환경 모두에서 활용 가능한 웨어러블 애플리케이션을 위한 모델

기존 PPG 기초 모델들의 한계 → 임상 데이터로만 학습됨

- 오픈소스 접근성 부족
- 태스크 간 일반화 능력 부족
- 현장 수집 웨어러블 데이터 적용성 부족

Pulse-PPG의 주요 특징:

- 최초의 오픈소스 웨어러블 PPG FM
- 데이터 규모: 120명 참가자, 21억 데이터 포인트, 822,247개의 4분 PPG 세그먼트
- 노이즈 필터링을 하지 않음 (실제 노이즈 패턴이 맥락 정보를 제공)

![image-20250304022547869](/assets/img2025-02-26 PPG 논문 고도화/image-20250304022547869.png)

저자들의 가설

- 현장 데이터에서 패턴을 효과적으로 학습하는 방법론 설계
- 더 강건하고 일반화가 잘되는 표현 학습 가능

현장 데이터 사전학습의 장점

노이즈의 긍정적 활용:

- 웨어러블 현장 센서의 노이즈가 오히려 이점
- 사용자의 현재 상태와 환경에 대한 추가적인 맥락 정보 제공

**전통적인 실험실 기반 학습의 패러다임을 바꾸는 중요한 시도**

![image-20250304022559351](/assets/img2025-02-26 PPG 논문 고도화/image-20250304022559351.png)

세 가지 환경에서의 PPG 신호를 비교

- Clinical: 가장 깨끗하고 규칙적인 신호
- Wearable Lab: 약간의 품질 저하가 있지만 관리 가능한 수준
- Wearable Field: 현저한 품질 저하
  - 원인: 일상적 착용 요인들
    - 동작 아티팩트
    - 주변 빛
    - 센서 접촉 불량

모티프 기반 방법론:

- 모티프: PPG 형태 내의 짧은 시간 패턴, 심박수, 혈압, 혈관 상태 등의 정보를 담고 있음
- 두 PPG 시퀀스를 비교할 때, 각 시퀀스의 모티프들을 비교
- 거리 함수를 사용해 얼마나 비슷한지 계산
- 가장 잘 매칭되는 모티프를 찾는 방식으로 학습

학습할때 이미지처럼 데이터를 변형하지는 않음

→ PPG데이터는 이런 변형이 의미를 왜곡시키기 때문



![image-20250304022635277](/assets/img2025-02-26 PPG 논문 고도화/image-20250304022635277.png)



모티프 기반 거리 함수의 수학적 구현

PPG 신호(Xanchor와 Xcand) 사이의 거리(유사도)를 계산

- 첫 번째 신호의 각 모티프(i)에 대해
- 두 번째 신호의 모든 모티프(j) 중에서
- 가장 잘 매칭되는(가장 거리가 가까운) 모티프를 찾습니다

AI가 직접 중요한 모티프 패턴을 학습

노이즈가 있는 상태에서도 의미 있는 모티프 매칭 가능

데이터에서 자동으로 중요한 패턴 발견

그리고 이외에 또 다른 수식들이 많았는데 너무 어려워서 일단 넘김



- 데이터셋
  - 120명의 참가자
  - 최대 100일간 스마트워치 착용
- 출처: MOODS (Mobile Open Observation of Daily Stressors)

1. 인코더 구조:

- 1D ResNet-26 네트워크 사용
- 총 28.5M 학습 가능 파라미터
- 주요 특징:
  - Instance normalization: 사용자/데이터셋 간 PPG 분포 변화 대응
  - 초기 필터 크기: 128
  - 커널 크기: 11
  - stride: 2
  - 12개의 residual 블록
    - 4블록마다 필터 크기 선형 증가
  - 글로벌 평균 시간 풀링
  - 출력: 512차원 임베딩 벡터 (가변 길이 PPG 신호 처리 가능)

1. 거리 함수 세부사항

- 특징:
  - 경량 모델 (127k 학습 가능 파라미터)
  - RelCon loss 함수를 위한 정적 함수로 사용
- 구조:
  - Dilated convolution 블록 시리즈
    - Dilated convolution layer + residual connection
    - ReLU + instance norm
  - 5개 블록
    - 초기 dilation: 1
    - 각 층마다 2배씩 증가
  - 필터 크기: 64
  - 커널 크기: 15
  - stride: 10
  - MSE loss를 거리 함수로 사용

![image-20250304022703484](/assets/img2025-02-26 PPG 논문 고도화/image-20250304022703484.png)

평가 방법: Linear probing

- 모델 임베딩을 고정(freeze)
- 단순 로지스틱 분류기/선형 회귀만 학습
- 목적: foundation model의 학습된 표현의 품질 평가

1. 비교 조건:

- 두 모델 모두 512차원 1D 벡터로 임베딩
- 구조적 차이에 의한 편향 방지

결과 분석:

1. 전반적 성능:

- Pulse-PPG가 11개 중 10개 태스크에서 PaPaGei 상회
- 모든 평가 지표에서 일관된 우수성
- 임상 태스크의 개선폭은 작지만 도메인 간 일반화 능력 입증

1. 한계점:

- 수면 장애 태스크에서 유일하게 성능 저하
- 원인: MOODS 데이터셋의 특성
  - 깨어있는 시간대 데이터만 수집
  - 수면 중 PPG 신호에 대한 학습 부족

**궁금해서 저자분께 월요일에 메일보냈는데 화요일에 답장이 왔음**

Q1. 코드 릴리스의 예상 일정

A1. 코드 출시 예정일은 약 4개월입니다.

Q2. MODS 데이터셋이 공개될지 여부

A2. 현재로서는 MODS 데이터셋을 공개할 계획이 없습니다.

Q3. 예비 자료나 추가 구현 세부 사항이 있는 경우 공유해 주실 수 있나요?

A3. 모티프 기반 거리 함수 구현에 대한 이해를 위해 다음 리소스를 사용하는 것이 도움이 될 수 있습니다: [GitHub. - rebar](https://github.com/maxxu05/rebar). - **REBAR: 시계열 대조 학습을 위한 검색 기반 재구성 2023.11**

Retrieval-Based Reconstruction

이 논문은 검색 기반 재구성함수로 모티프를 찾는 비슷한 뉘앙스의 내용이어서

github에서 코드 가져와서 어디부분이 코드를 확인해봤는데 직접적으로 코드를 사용한게 아닌건지 아니면 내가 못 찾는건지 뭐 쨋든 그럼.

데이터 전처리함수 돌리고 run해보려다가 이건 상관없는 부분이지 않나? 이 코드에서 저 함수 메소드만 착안했다한건가? 이것도 잘 모르겠어서 안 돌려봄.

A3. 상대적 대조 손실에 관해서는 이 논문을 참조하여 더 자세한 내용을 확인할 수 있습니다:

[Relative Contrastive Loss (arXiv:2411.18822)](https://arxiv.org/abs/2411.18822)

해당 코드는 향후 2주 이내에 출시될 예정입니다.

Q4. 초기 실험과 개념 증명에 사용할 수 있는 대체 데이터셋에 대한 제안도 주시면 감사하겠습니다.

A4. 또한, 이 논문에서는 다른 데이터셋에 대한 유용한 정보를 찾을 수 있습니다: https://dl.acm.org/doi/abs/10.1145/3678578 - **A Reproducible Stress Prediction Pipeline with Mobile Sensor Data**

원래 계획은 코드가 릴리즈되어있거나 금방 나온다면 그걸 토대로 고도화 할예정이었는데 4개월이후에 나온대서 2가지로 방향성이 생겼음

1. 직접 논문을 코드화 해보기. 이 경우 문제가 코드가 없으므로 구현의 난이도 높음과 데이터셋도 논문과 다른 걸 써야하기에 까다로울 수 있음.
2. 저자나 다른 기여자가 코드가 릴리즈하는 걸 기다리다가 고도화하기.

논문의 주제는 상당히 마음에 들었는데 생각이 많아짐. 코드 가져와서 한번 보기도하고 그랬는데 어려운느낌. 바람직한 방향성이 어딘지 혼자 선택하기 어려워서 코드화 해보려다가 우선 다른 논문부터 좀 만져보기로 함.

**광전혈류촬영법을 통한 인공 지능 유래 혈관 연령: 심혈관 건강을 위한 새로운 디지털 바이오마커**

https://arxiv.org/html/2502.12990v2 **- 2025년 2월 19일 - 코드 있음**

코드잇는걸로 다음거 계속 해보기 기초적인 머신러닝느낌으로







