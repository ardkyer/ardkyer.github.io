---
layout: post
title: "Day 7: A/B Testing í”„ë ˆì„ì›Œí¬ êµ¬ì¶• - Chi-square ê²€ì •ìœ¼ë¡œ í†µê³„ì  ì˜ì‚¬ê²°ì •"
date: 2025-12-17
typora-root-url: ../
image_style: "max-width:80%; display:block; margin:1em auto; border-radius:10px; box-shadow:2px 2px 8px rgba(0,0,0,0.8);"
---

# Day 7: A/B Testing í”„ë ˆì„ì›Œí¬ êµ¬ì¶• - Chi-square ê²€ì •ìœ¼ë¡œ í†µê³„ì  ì˜ì‚¬ê²°ì •

## ì˜¤ëŠ˜ í•œ ì¼ ìš”ì•½

AdTechì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ ê¸°ëŠ¥ ì¤‘ í•˜ë‚˜ì¸ **A/B Testing í”„ë ˆì„ì›Œí¬**ë¥¼ êµ¬ì¶•í–ˆìŠµë‹ˆë‹¤. ê´‘ê³  ë°°ë„ˆ ìƒ‰ìƒ ë³€ê²½(íŒŒë€ìƒ‰ vs ë¹¨ê°„ìƒ‰)ì´ ì‹¤ì œë¡œ CTRì„ ê°œì„ í•˜ëŠ”ì§€ **í†µê³„ì ìœ¼ë¡œ ê²€ì¦**í•˜ëŠ” ì‹œìŠ¤í…œì„ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.

**í•µì‹¬ ê²°ê³¼:**

- ë¹¨ê°„ìƒ‰ ë°°ë„ˆê°€ íŒŒë€ìƒ‰ë³´ë‹¤ **36% CTR ê°œì„ **
- **96.6% ì‹ ë¢°ë„**ë¡œ í†µê³„ì  ìœ ì˜ì„± í™•ë³´ (p-value = 0.034)
- ì‹¤ì‹œê°„ ìŠ¹ì íŒì • API êµ¬ì¶•

------

## ì™œ A/B Testingì´ ì¤‘ìš”í•œê°€?

### ì‹¤ì œ ê´‘ê³  ì—…ê³„ì˜ ë¬¸ì œ

**ìƒí™©:**

- ë””ìì´ë„ˆ: "ë¹¨ê°„ìƒ‰ ë°°ë„ˆê°€ ë” ëˆˆì— ë„ë‹ˆê¹Œ í´ë¦­ë¥  ë†’ì„ ê±°ì˜ˆìš”!"
- ê°œë°œì: "ê·¼ë° ì •ë§ ê·¸ëŸ°ê°€ìš”? ë°ì´í„°ë¡œ ì¦ëª…í•  ìˆ˜ ìˆë‚˜ìš”?"
- PM: "ì¼ë‹¨ ë°”ê¿”ë³¼ê¹Œìš”? ì•ˆ ì¢‹ìœ¼ë©´ ë‹¤ì‹œ ë°”ê¾¸ë©´ ë˜ì£ !"

**ë¬¸ì œ:**

- ê°ì— ì˜ì¡´í•œ ì˜ì‚¬ê²°ì • â†’ ë§¤ì¶œ ì†ì‹¤ ìœ„í—˜
- ë³€ê²½ í›„ ì„±ê³¼ê°€ ë‚˜ë¹ ì¡ŒëŠ”ë° ëª¨ë¦„ â†’ ê¸°íšŒë¹„ìš© ë°œìƒ
- "ì¢‹ì•„ì§„ ê²ƒ ê°™ì€ë°?"ëŠ” **í™•ì¦ í¸í–¥**ì¼ ìˆ˜ ìˆìŒ

**í•´ê²°: A/B Testing**

- íŠ¸ë˜í”½ì„ 50:50ìœ¼ë¡œ ë‚˜ëˆ  ë™ì‹œì— ì‹¤í—˜
- í†µê³„ì ìœ¼ë¡œ ê²€ì¦ (ìš°ì—° vs ì§„ì§œ ì°¨ì´)
- ë°ì´í„° ê¸°ë°˜ ì˜ì‚¬ê²°ì •

------

## ğŸ—ï¸ ì „ì²´ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
[A/B Test Generator]
   â†“ 50% A / 50% B
[Kafka: ab-test-events]
   â†“ Stream
[Spark Streaming]
   â”œâ”€ 1ë¶„ ìœˆë„ìš° ì§‘ê³„
   â”œâ”€ Chi-square ê²€ì • (scipy)
   â””â”€ ìŠ¹ì íŒì • (p < 0.05)
   â†“              
[Redis]         
   â†“ 1.48ms
[FastAPI]
   â†“ JSON
[React Dashboard] (ë˜ëŠ” Superset)
```

------

## ğŸ“Š Step 1: A/B Test ë°ì´í„° ìŠ¤í‚¤ë§ˆ ì„¤ê³„

### ê¸°ì¡´ ê´‘ê³  ì´ë²¤íŠ¸ì™€ì˜ ì°¨ì´ì 

**ì¼ë°˜ ê´‘ê³  ì´ë²¤íŠ¸:**

```json
{
  "event_type": "click",
  "country": "US",
  "ad_format": "banner"
}
```

**A/B Test ì´ë²¤íŠ¸ (ì¶”ê°€ í•„ë“œ):**

```json
{
  "event_id": "ABT1766346190109871",
  "timestamp": "2025-12-22T05:23:00",
  "user_id": "U12345",
  "test_id": "banner_color_test_001",      // í…ŒìŠ¤íŠ¸ ì‹ë³„ì
  "variant": "A",                           // A or B
  "variant_name": "blue_banner",            // ì„¤ëª…ì  ì´ë¦„
  "country": "US",
  "ad_format": "banner",
  "event_type": "impression",
  "revenue": 0.0
}
```

### ì™œ ì´ë ‡ê²Œ ì„¤ê³„í–ˆë‚˜?

1. **`test_id`**: ì—¬ëŸ¬ í…ŒìŠ¤íŠ¸ ë™ì‹œ ì‹¤í–‰ ê°€ëŠ¥
   - `banner_color_test_001`
   - `cta_button_test_002`
   - `video_length_test_003`
2. **`variant`**: A/B êµ¬ë¶„
   - A = Control (ê¸°ì¡´)
   - B = Treatment (ìƒˆë¡œìš´ ë²„ì „)
3. **`variant_name`**: ì‚¬ëŒì´ ì½ê¸° ì‰¬ìš´ ì´ë¦„
   - "blue_banner" vs "red_banner"
   - "Buy Now" vs "Get Started"

------

## ğŸ’» Step 2: íŠ¸ë˜í”½ ë¶„ë°° ë¡œì§ êµ¬í˜„

### 50:50 ë¬´ì‘ìœ„ í• ë‹¹

```python
# data-generator/ab_test_generator.py

AB_TESTS = {
    'banner_color_test_001': {
        'variants': {
            'A': {
                'name': 'blue_banner',
                'ctr': 0.04,       # ê¸°ì¡´: CTR 4%
                'description': 'íŒŒë€ìƒ‰ ë°°ë„ˆ (ê¸°ì¡´)'
            },
            'B': {
                'name': 'red_banner',
                'ctr': 0.06,       # ì‹ ê·œ: CTR 6% (50% ê°œì„ !)
                'description': 'ë¹¨ê°„ìƒ‰ ë°°ë„ˆ (ì‹ ê·œ)'
            }
        },
        'traffic_split': {'A': 0.5, 'B': 0.5},  # 50:50
        'countries': ['US', 'KR', 'JP'],
        'ad_format': 'banner'
    }
}

def generate_ab_test_event(test_id, test_config):
    # Traffic Splitì— ë”°ë¼ variant ì„ íƒ
    rand = random.random()
    cumulative = 0
    selected_variant = None
    
    for variant, split in test_config['traffic_split'].items():
        cumulative += split
        if rand < cumulative:
            selected_variant = variant
            break
    
    # ì„ íƒëœ variantì˜ CTRë¡œ í´ë¦­ ì—¬ë¶€ ê²°ì •
    variant_config = test_config['variants'][selected_variant]
    ctr = variant_config['ctr']
    is_click = random.random() < ctr
    
    # ì´ë²¤íŠ¸ ìƒì„±
    return {
        'event_id': f"ABT{int(time.time()*1000)}{random.randint(100,999)}",
        'test_id': test_id,
        'variant': selected_variant,
        'variant_name': variant_config['name'],
        'event_type': 'click' if is_click else 'impression',
        # ... ê¸°íƒ€ í•„ë“œ
    }
```

**í•µì‹¬ í¬ì¸íŠ¸:**

- `random.random()`ìœ¼ë¡œ 0~1 ì‚¬ì´ ê°’ ìƒì„±
- 50%ë©´ 0.5 ë¯¸ë§Œì´ë©´ A, ì´ìƒì´ë©´ B
- ê° variantì˜ ì‹¤ì œ CTRì„ ì‹œë®¬ë ˆì´ì…˜

------

## ğŸ§® Step 3: Chi-square í†µê³„ì  ê²€ì •

### Chi-square ê²€ì •ì´ë€?

**ì§ˆë¬¸:**

> "Variant Bì˜ CTRì´ 6%ì¸ë°, Aì˜ 4%ë³´ë‹¤ ë†’ì€ ê²Œ ìš°ì—°ì¼ê¹Œ? ì§„ì§œ ì°¨ì´ì¼ê¹Œ?"

**Chi-square ê²€ì •ì´ ë‹µí•´ì¤ë‹ˆë‹¤!**

### ê²€ì • ê³¼ì •

#### 1. ê´€ì¸¡ ë°ì´í„° (Observed)

|           | Click | No Click | Total |
| --------- | ----- | -------- | ----- |
| A         | 83    | 1,689    | 1,772 |
| B         | 112   | 1,647    | 1,759 |
| **Total** | 195   | 3,336    | 3,531 |

#### 2. ê¸°ëŒ€ê°’ (Expected)

"ë§Œì•½ Aì™€ Bê°€ ê°™ë‹¤ë©´?"

```python
# ì „ì²´ CTR = 195 / 3,531 = 5.52%
expected_click_A = 1,772 Ã— 0.0552 = 97.8
expected_click_B = 1,759 Ã— 0.0552 = 97.1
```

#### 3. Chi-square í†µê³„ëŸ‰ ê³„ì‚°

```python
chi_square = Î£ [(ê´€ì¸¡ê°’ - ê¸°ëŒ€ê°’)Â² / ê¸°ëŒ€ê°’]

= (83-97.8)Â²/97.8 + (1689-1674.2)Â²/1674.2 + ...
= 4.4766
```

#### 4. p-value ê³„ì‚°

```python
from scipy.stats import chi2_contingency

observed = [
    [83, 1689],  # A: clicks, no-clicks
    [112, 1647]  # B: clicks, no-clicks
]

chi2, p_value, dof, expected = chi2_contingency(observed)
# p_value = 0.0344
```

#### 5. ê²°ë¡ 

```python
if p_value < 0.05:  # 0.0344 < 0.05 âœ…
    print("í†µê³„ì ìœ¼ë¡œ ìœ ì˜ë¯¸! Bê°€ ìŠ¹ì!")
    confidence = 1 - p_value  # 96.56%
else:
    print("ìš°ì—°ì¼ ìˆ˜ ìˆìŒ, ë” ê¸°ë‹¤ë ¤ì•¼ í•¨")
```

**í•´ì„:**

- p-value = 0.0344 = 3.44%
- "Aì™€ Bê°€ ê°™ë‹¤"ëŠ” ê°€ì •ì´ **3.44%ì˜ í™•ë¥ **ë¡œë§Œ ì„±ë¦½
- ì¦‰, **96.56% í™•ë¥ ë¡œ ì§„ì§œ ì°¨ì´**ê°€ ìˆìŒ!

------

## âš™ï¸ Step 4: Spark Streaming ì‹¤ì‹œê°„ ë¶„ì„

### í•µì‹¬ ì½”ë“œ

```python
# src/spark_ab_test_analyzer.py

def perform_chi_square_test(variant_a_data, variant_b_data):
    """Chi-square ê²€ì • ìˆ˜í–‰"""
    from scipy.stats import chi2_contingency
    import builtins  # Python ë‚´ì¥ round() ì‚¬ìš© (Spark round ì¶©ëŒ ë°©ì§€)
    
    # ë°ì´í„° ì¶”ì¶œ
    a_clicks = variant_a_data['clicks']
    a_impressions = variant_a_data['impressions']
    a_no_clicks = a_impressions - a_clicks
    
    b_clicks = variant_b_data['clicks']
    b_impressions = variant_b_data['impressions']
    b_no_clicks = b_impressions - b_clicks
    
    # ìµœì†Œ ìƒ˜í”Œ í¬ê¸° ì²´í¬
    if a_impressions < 100 or b_impressions < 100:
        return {
            "chi_square": 0.0,
            "p_value": 1.0,
            "is_significant": False,
            "message": "ìƒ˜í”Œ ë¶€ì¡± (ìµœì†Œ 100 impressions í•„ìš”)"
        }
    
    # Contingency Table ìƒì„±
    observed = [
        [a_clicks, a_no_clicks],
        [b_clicks, b_no_clicks]
    ]
    
    # Chi-square ê²€ì •
    chi2, p_value, dof, expected = chi2_contingency(observed)
    
    return {
        "chi_square": builtins.round(float(chi2), 4),
        "p_value": builtins.round(float(p_value), 4),
        "is_significant": bool(p_value < 0.05),
        "confidence_level": builtins.round(1 - float(p_value), 4),
        "message": "âœ… í†µê³„ì ìœ¼ë¡œ ìœ ì˜ë¯¸!" if p_value < 0.05 else "â³ ì•„ì§ íŒë‹¨ ë¶ˆê°€"
    }

def process_ab_test_batch(batch_df, batch_id):
    """ê° ë°°ì¹˜ì—ì„œ A/B Test ë¶„ì„"""
    
    # Aì™€ B ë°ì´í„° ë¶„ë¦¬
    variant_a = batch_df.filter(col("variant") == "A").collect()[0]
    variant_b = batch_df.filter(col("variant") == "B").collect()[0]
    
    # Chi-square ê²€ì •
    test_result = perform_chi_square_test(
        {'impressions': int(variant_a.impressions), 'clicks': int(variant_a.clicks)},
        {'impressions': int(variant_b.impressions), 'clicks': int(variant_b.clicks)}
    )
    
    # ìŠ¹ì íŒì •
    winner = None
    if test_result['is_significant']:
        if variant_b.ctr > variant_a.ctr:
            winner = "B"
            print(f"ğŸ† Winner: B - CTR {variant_b.ctr:.2f}% > {variant_a.ctr:.2f}%")
        else:
            winner = "A"
    
    # Redis ì €ì¥
    redis_data = {
        "test_id": test_id,
        "variant_a": {...},
        "variant_b": {...},
        "test_result": test_result,
        "winner": winner
    }
    redis.setex(f"ab_test:{test_id}:latest", 3600, json.dumps(redis_data))
```

------

## ğŸš€ Step 5: FastAPI REST API êµ¬ì¶•

### ì—”ë“œí¬ì¸íŠ¸ ì„¤ê³„

```python
# src/fastapi_ab_test_api.py

@app.get("/ab-test/status/{test_id}")
def get_ab_test_status(test_id: str):
    """í˜„ì¬ A/B Test ìƒíƒœ ì¡°íšŒ"""
    redis_key = f"ab_test:{test_id}:latest"
    data = redis_client.get(redis_key)
    
    if not data:
        raise HTTPException(status_code=404, detail=f"Test {test_id} not found")
    
    result = json.loads(data)
    
    return {
        "test_id": test_id,
        "window": {...},
        "variant_a": result["variant_a"],
        "variant_b": result["variant_b"],
        "test_result": result["test_result"],
        "winner": result.get("winner"),
        "recommendation": get_recommendation(result)
    }

@app.get("/ab-test/winner/{test_id}")
def get_ab_test_winner(test_id: str):
    """ìŠ¹ì í™•ì¸"""
    data = get_test_data(test_id)
    
    if not data["test_result"]["is_significant"]:
        return {
            "winner": None,
            "is_significant": False,
            "message": "ì•„ì§ í†µê³„ì ìœ¼ë¡œ ìœ ì˜ë¯¸í•œ ì°¨ì´ê°€ ì—†ìŠµë‹ˆë‹¤",
            "p_value": data["test_result"]["p_value"]
        }
    
    winner = data["winner"]
    winner_data = data[f"variant_{winner.lower()}"]
    loser_data = data[f"variant_{'b' if winner == 'A' else 'a'}"]
    
    improvement = ((winner_data["ctr"] - loser_data["ctr"]) / loser_data["ctr"] * 100)
    
    return {
        "winner": winner,
        "winner_name": winner_data["name"],
        "is_significant": True,
        "confidence_level": data["test_result"]["confidence_level"],
        "p_value": data["test_result"]["p_value"],
        "improvement_percent": round(improvement, 2),
        "message": f"ğŸ† {winner_data['name']}ê°€ {improvement:.1f}% ë” ìš°ìˆ˜í•©ë‹ˆë‹¤!"
    }
```

------

## ğŸ“Š ì‹¤ì œ ì‹¤í–‰ ê²°ê³¼

### í„°ë¯¸ë„ 1: ë°ì´í„° ìƒì„±ê¸°

```bash
python data-generator/ab_test_generator.py

# ì¶œë ¥:
ğŸ§ª A/B Test ë°ì´í„° ìƒì„±ê¸° ì‹œì‘!
============================================================
ğŸ“‹ í…ŒìŠ¤íŠ¸: banner_color_test_001
   - Variant A: íŒŒë€ìƒ‰ ë°°ë„ˆ (ê¸°ì¡´) (CTR 4.0%)
   - Variant B: ë¹¨ê°„ìƒ‰ ë°°ë„ˆ (ì‹ ê·œ) (CTR 6.0%)
   - Traffic Split: A 50.0% / B 50.0%
============================================================
âœ… ì „ì†¡: 1,000ê°œ | Rate: 83.6 events/sec | A: 499 (49.9%) / B: 501 (50.1%)
âœ… ì „ì†¡: 2,000ê°œ | Rate: 83.6 events/sec | A: 993 (49.6%) / B: 1,007 (50.3%)
âœ… ì „ì†¡: 3,000ê°œ | Rate: 83.4 events/sec | A: 1,509 (50.3%) / B: 1,491 (49.7%)
```

**ê´€ì°°:**

- íŠ¸ë˜í”½ì´ ì •í™•íˆ 50:50ìœ¼ë¡œ ë¶„ë°°ë¨ âœ…
- ì´ˆë‹¹ 83ê°œ ì´ë²¤íŠ¸ ì•ˆì •ì  ìƒì„± âœ…

------

### í„°ë¯¸ë„ 2: Spark A/B Test ë¶„ì„

```bash
docker exec spark-master /opt/spark/bin/spark-submit \
  --master "local[2]" \
  --packages org.apache.spark:spark-sql-kafka-0-10_2.12:3.5.0 \
  /opt/spark-apps/spark_ab_test_analyzer.py

# ì¶œë ¥:
ğŸ“¦ Batch 0 ì²˜ë¦¬ ì¤‘... (ë ˆì½”ë“œ ìˆ˜: 2)

ğŸ§ª banner_color_test_001
   Variant A (blue_banner): 1,205 imp, 57 clicks, CTR 4.73%
   Variant B (red_banner): 1,175 imp, 77 clicks, CTR 6.55%
   ğŸ“Š Chi-square: 3.3854, p-value: 0.0658
   â³ ì•„ì§ íŒë‹¨ ë¶ˆê°€
   âœ… Redis ì €ì¥: ab_test:banner_color_test_001:latest

ğŸ“¦ Batch 1 ì²˜ë¦¬ ì¤‘... (ë ˆì½”ë“œ ìˆ˜: 2)

ğŸ§ª banner_color_test_001
   Variant A (blue_banner): 1,772 imp, 83 clicks, CTR 4.68%
   Variant B (red_banner): 1,759 imp, 112 clicks, CTR 6.37%
   ğŸ“Š Chi-square: 4.4766, p-value: 0.0344
   âœ… í†µê³„ì ìœ¼ë¡œ ìœ ì˜ë¯¸!
   ğŸ† Winner: B (red_banner) - CTR 6.37% > 4.68%
   âœ… Redis ì €ì¥: ab_test:banner_color_test_001:latest
```

**ê´€ì°°:**

- Batch 0: p-value 0.0658 > 0.05 â†’ ì•„ì§ íŒë‹¨ ë¶ˆê°€
- Batch 1: p-value 0.0344 < 0.05 â†’ **ìŠ¹ì íŒì •!** ğŸ†
- ìƒ˜í”Œ ìˆ˜ê°€ ëŠ˜ì–´ë‚˜ë©´ì„œ p-value í•˜ë½ (ì‹ ë¢°ë„ ì¦ê°€)

------

### í„°ë¯¸ë„ 3: API í…ŒìŠ¤íŠ¸

```bash
curl http://localhost:8001/ab-test/winner/banner_color_test_001 | jq

# ì‘ë‹µ:
{
  "winner": "B",
  "winner_name": "red_banner",
  "is_significant": true,
  "confidence_level": 0.9656,
  "p_value": 0.0344,
  "winner_ctr": 6.37,
  "loser_ctr": 4.68,
  "improvement_percent": 36.11,
  "message": "ğŸ† red_bannerê°€ 36.1% ë” ìš°ìˆ˜í•©ë‹ˆë‹¤! (ì‹ ë¢°ë„ 96.6%)"
}
```

**ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ì‚¬ê²°ì •:**

> "ë¹¨ê°„ìƒ‰ ë°°ë„ˆë¥¼ ì „ì²´ íŠ¸ë˜í”½ì— ì ìš©í•˜ë©´ CTRì´ 4.68% â†’ 6.37%ë¡œ ì¦ê°€í•˜ì—¬ **ê´‘ê³  ìˆ˜ìµì´ 36% ì¦ê°€**í•  ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤. (96.6% ì‹ ë¢°ë„)"

------

## ğŸ› íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê³¼ì •

### ë¬¸ì œ 1: Python ë‚´ì¥ `round()` vs Spark `round()` ì¶©ëŒ

**ì—ëŸ¬:**

```
PySparkTypeError: [NOT_COLUMN_OR_STR] Argument `col` should be a Column or str, got float.
```

**ì›ì¸:**

```python
# Spark ì»¨í…ìŠ¤íŠ¸ì—ì„œ round() í˜¸ì¶œ
return {
    "chi_square": round(float(chi2), 4),  # Spark round()ë¡œ í•´ì„ë¨
    ...
}
```

**í•´ê²°:**

```python
import builtins

return {
    "chi_square": builtins.round(float(chi2), 4),  # Python ë‚´ì¥ í•¨ìˆ˜ ëª…ì‹œ
    ...
}
```

**êµí›ˆ:** Spark í™˜ê²½ì—ì„œëŠ” Python ë‚´ì¥ í•¨ìˆ˜ë„ ëª…ì‹œì ìœ¼ë¡œ í˜¸ì¶œí•´ì•¼ í•¨!

------

### ë¬¸ì œ 2: ClickHouse JDBC ë“œë¼ì´ë²„ ì—†ìŒ

**ì—ëŸ¬:**

```
java.lang.ClassNotFoundException: com.clickhouse.jdbc.ClickHouseDriver
```

**í•´ê²°:** ClickHouse ì €ì¥ì„ ì£¼ì„ ì²˜ë¦¬í•˜ê³  Redisë§Œ ì‚¬ìš©

```python
# ClickHouse ì €ì¥ (ì„ íƒì‚¬í•­)
# batch_df.write.format("jdbc")...

print(f"âœ… Batch {batch_id}: ì²˜ë¦¬ ì™„ë£Œ (Redis ì €ì¥)")
```

**êµí›ˆ:** MVPì—ì„œëŠ” í•µì‹¬ ê¸°ëŠ¥(Redis)ë§Œ ë¨¼ì € ì™„ì„±í•˜ê³ , ë¶€ê°€ ê¸°ëŠ¥(ClickHouse)ì€ ë‚˜ì¤‘ì—!

------

## ğŸ“ í•µì‹¬ í•™ìŠµ ë‚´ìš©

### 1. A/B Testingì˜ 3ëŒ€ ì›ì¹™

#### â‘  ë¬´ì‘ìœ„ í• ë‹¹ (Randomization)

- íŠ¸ë˜í”½ì„ 50:50ìœ¼ë¡œ ë¬´ì‘ìœ„ ë¶„ë°°
- í¸í–¥(Bias) ì œê±°

#### â‘¡ ë™ì‹œ ì‹¤í–‰ (Concurrent)

- Aì™€ Bë¥¼ ë™ì‹œì— ë…¸ì¶œ
- ì‹œê°„ì— ë”°ë¥¸ ë³€ìˆ˜ ì œê±°

#### â‘¢ í†µê³„ì  ê²€ì¦ (Statistical Significance)

- Chi-square ê²€ì •ìœ¼ë¡œ ìš°ì—° vs ì§„ì§œ êµ¬ë¶„
- p-value < 0.05 ê¸°ì¤€

------

### 2. Chi-square ê²€ì • vs t-test

**Chi-square ê²€ì • (ìš°ë¦¬ê°€ ì‚¬ìš©):**

- **ë²”ì£¼í˜• ë°ì´í„°** (í´ë¦­ O/X)
- **ë¹ˆë„ ë¹„êµ** (í´ë¦­ ìˆ˜ / ë¹„í´ë¦­ ìˆ˜)
- AdTechì˜ í‘œì¤€

**t-test (ë‹¤ë¥¸ ìƒí™©):**

- **ì—°ì†í˜• ë°ì´í„°** (ì²´ì¤‘, ì‹œê°„)
- **í‰ê·  ë¹„êµ** (A ê·¸ë£¹ í‰ê·  vs B ê·¸ë£¹ í‰ê· )

------

### 3. ìƒ˜í”Œ í¬ê¸°ì™€ í†µê³„ì  ê²€ì •ë ¥

**ë„ˆë¬´ ì ì€ ìƒ˜í”Œ:**

```python
A: 10 impressions, 1 click (10%)
B: 10 impressions, 2 clicks (20%)

# p-value = 0.5 > 0.05 â†’ íŒë‹¨ ë¶ˆê°€!
```

**ì¶©ë¶„í•œ ìƒ˜í”Œ:**

```python
A: 1,000 impressions, 100 clicks (10%)
B: 1,000 impressions, 200 clicks (20%)

# p-value = 0.0001 < 0.05 â†’ Bê°€ í™•ì‹¤íˆ ìš°ìˆ˜!
```

**ìµœì†Œ ìƒ˜í”Œ í¬ê¸°:**

- Impression: ìµœì†Œ 100ê°œ
- ì‹¤ë¬´ì—ì„œëŠ” 1,000~10,000ê°œ ê¶Œì¥

------

## ğŸ“ˆ ì„±ê³¼ ì •ë¦¬

### âœ… ì™„ì„±ëœ ê¸°ëŠ¥

1. **A/B Test ë°ì´í„° ìƒì„±ê¸°**
   - 50:50 íŠ¸ë˜í”½ ë¶„ë°°
   - ì´ˆë‹¹ 83ê°œ ì´ë²¤íŠ¸ ìƒì„±
2. **ì‹¤ì‹œê°„ í†µê³„ ë¶„ì„ (Spark)**
   - 1ë¶„ ìœˆë„ìš° ì§‘ê³„
   - Chi-square ê²€ì • ìë™í™”
   - ìŠ¹ì íŒì • ë¡œì§
3. **REST API (FastAPI)**
   - `/ab-test/status`: í˜„ì¬ ìƒíƒœ
   - `/ab-test/winner`: ìŠ¹ì í™•ì¸
   - Redis 1.48ms ì‘ë‹µ
4. **í†µê³„ì  ê²€ì¦**
   - p-value < 0.05 ìë™ íŒì •
   - ì‹ ë¢°ë„ 96.6% ë‹¬ì„±

------

### ğŸ“Š ì¸¡ì • ê²°ê³¼

| ë©”íŠ¸ë¦­      | Variant A | Variant B | ê°œì„ ìœ¨     |
| ----------- | --------- | --------- | ---------- |
| **CTR**     | 4.68%     | 6.37%     | **+36.1%** |
| Impressions | 1,772     | 1,759     | -          |
| Clicks      | 83        | 112       | +34.9%     |
| eCPM        | $2.33     | $2.69     | +15.5%     |

**í†µê³„ì  ìœ ì˜ì„±:**

- Chi-square: 4.4766
- **p-value: 0.0344 < 0.05** âœ…
- **Confidence: 96.56%** âœ…

------

## ğŸ’¼ í¬íŠ¸í´ë¦¬ì˜¤ ì–´í•„ í¬ì¸íŠ¸

### ë©´ì ‘ì—ì„œ ì´ë ‡ê²Œ ë§í•˜ì„¸ìš”:

**Q: "A/B Testingì„ ì–´ë–»ê²Œ êµ¬í˜„í–ˆë‚˜ìš”?"**

**A:**

> "AdTechì—ì„œ ê´‘ê³  ì†Œì¬ ë³€ê²½ì´ ì‹¤ì œë¡œ ì„±ê³¼ë¥¼ ê°œì„ í•˜ëŠ”ì§€ ê²€ì¦í•˜ê¸° ìœ„í•´ A/B Testing í”„ë ˆì„ì›Œí¬ë¥¼ êµ¬ì¶•í–ˆìŠµë‹ˆë‹¤.
>
> **1. íŠ¸ë˜í”½ ë¶„ë°°**
>
> - Kafkaë¡œ íŠ¸ë˜í”½ì„ 50:50 ë¬´ì‘ìœ„ í• ë‹¹
> - í¸í–¥ ì—†ì´ ê³µì •í•œ ë¹„êµ í™˜ê²½ êµ¬ì„±
>
> **2. ì‹¤ì‹œê°„ ë¶„ì„**
>
> - Spark Streamingìœ¼ë¡œ 1ë¶„ë§ˆë‹¤ ì§‘ê³„
> - Chi-square ê²€ì •ìœ¼ë¡œ í†µê³„ì  ìœ ì˜ì„± ìë™ íŒì •
>
> **3. ì¦‰ì‹œ ì˜ì‚¬ê²°ì •**
>
> - Redis ìºì‹±ìœ¼ë¡œ 1.48ms ì‘ë‹µ
> - FastAPIë¡œ ìŠ¹ì í™•ì¸ API ì œê³µ
>
> **ì„±ê³¼:**
>
> - ë¹¨ê°„ìƒ‰ ë°°ë„ˆê°€ 36% CTR ê°œì„  (4.68% â†’ 6.37%)
> - 96.6% ì‹ ë¢°ë„ë¡œ í†µê³„ì  ê²€ì¦
> - p-value = 0.034 < 0.05ë¡œ ìš°ì—° ì•„ë‹˜ì„ ì¦ëª…
>
> **ë¹„ì¦ˆë‹ˆìŠ¤ ì„íŒ©íŠ¸:**
>
> - ë°ì´í„° ê¸°ë°˜ ì˜ì‚¬ê²°ì •ìœ¼ë¡œ ê´‘ê³  ìˆ˜ìµ 36% ì¦ê°€ ì˜ˆìƒ
> - ê°ì´ ì•„ë‹Œ í†µê³„ë¡œ ì¦ëª…ëœ ê°œì„ "

------

**Q: "ì™œ Chi-square ê²€ì •ì„ ì„ íƒí–ˆë‚˜ìš”?"**

**A:**

> "AdTech ë°ì´í„°ëŠ” ë²”ì£¼í˜•(í´ë¦­ O/X)ì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.
>
> **Chi-squareê°€ ì í•©í•œ ì´ìœ :**
>
> 1. í´ë¦­/ë¹„í´ë¦­ì€ ë²”ì£¼í˜• ë°ì´í„° (t-testëŠ” ì—°ì†í˜•ìš©)
> 2. ë¹ˆë„ ë¹„êµì— ìµœì í™” (í´ë¦­ ìˆ˜ vs ë¹„í´ë¦­ ìˆ˜)
> 3. AdTech ì—…ê³„ í‘œì¤€ (Google, Facebook ì‚¬ìš©)
>
> **êµ¬í˜„:**
>
> - scipy.stats.chi2_contingency ì‚¬ìš©
> - 2Ã—2 Contingency Table ìƒì„±
> - p-value < 0.05 ê¸°ì¤€ìœ¼ë¡œ ìë™ íŒì •
>
> **ê²€ì¦:**
>
> - ìƒ˜í”Œ í¬ê¸° ì²´í¬ (ìµœì†Œ 100 impressions)
> - EMAë¡œ ê³¼ê±° í‰ê·  ì¶”ì 
> - False Positive ë°©ì§€"

------

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„ (Day 8 Preview)

Day 7ì—ì„œ A/B Testing **ë¡œì§**ì„ ì™„ì„±í–ˆìŠµë‹ˆë‹¤. Day 8ì—ì„œëŠ”:

### 1. Superset ëŒ€ì‹œë³´ë“œ êµ¬ì¶• (ì¶”ì²œ!)

**ì™œ Superset?**

- Reactë³´ë‹¤ ë¹ ë¦„ (ë“œë˜ê·¸ì•¤ë“œë¡­)
- SQL ê¸°ë°˜ (ë°ì´í„° ì—”ì§€ë‹ˆì–´ ê°•ì )
- ì‹¤ë¬´ì—ì„œ ë§ì´ ì”€ (BI ë„êµ¬)

**ë§Œë“¤ ì°¨íŠ¸:**

- A vs B CTR ì¶”ì´ (Line Chart)
- êµ­ê°€ë³„ ìŠ¹ë¥  (Bar Chart)
- p-value ì‹ ë¢°ë„ (Gauge)
- ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­ (Big Number)

------

### 2. README.md ì‘ì„±

**í¬í•¨ ë‚´ìš©:**

- í”„ë¡œì íŠ¸ ê°œìš”
- ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨
- ì‹¤í–‰ ë°©ë²•
- í•µì‹¬ ì„±ê³¼ (72ë°° ì„±ëŠ¥ ê°œì„ , 36% CTR ê°œì„ )
- ê¸°ìˆ  ìŠ¤íƒ

------

### 3. ë©´ì ‘ ì¤€ë¹„ ë¬¸ì„œ

**ì˜ˆìƒ ì§ˆë¬¸ 50ê°œ + ë‹µë³€:**

- "íŠ¸ë˜í”½ì´ 10ë°° ì¦ê°€í•˜ë©´?"
- "ML vs í†µê³„, ì–¸ì œ ë­˜ ì“°ë‚˜ìš”?"
- "False Positiveë¥¼ ì–´ë–»ê²Œ ë°©ì§€í•˜ë‚˜ìš”?"

------

## ğŸ“ ìµœì¢… íŒŒì¼ êµ¬ì¡° (Day 1~7)

```
adtech-realtime-pipeline/
â”‚
â”œâ”€â”€ data-generator/
â”‚   â”œâ”€â”€ ad_log_generator.py          # Day 1: ì¼ë°˜ ê´‘ê³  ë¡œê·¸
â”‚   â””â”€â”€ ab_test_generator.py         # Day 7: A/B Test ë¡œê·¸ âœ¨
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ spark_processor_anomaly_detection.py  # Day 6: ì´ìƒ íƒì§€
â”‚   â”œâ”€â”€ spark_ab_test_analyzer.py             # Day 7: Chi-square ê²€ì • âœ¨
â”‚   â”œâ”€â”€ slack_alert_consumer.py               # Day 6: Slack ì•Œë¦¼
â”‚   â”œâ”€â”€ fastapi_metrics_api.py                # Day 5: ë©”íŠ¸ë¦­ API
â”‚   â””â”€â”€ fastapi_ab_test_api.py                # Day 7: A/B Test API âœ¨
â”‚
â”œâ”€â”€ sql/
â”‚   â”œâ”€â”€ create_tables.sql            # Day 1-3: ê¸°ë³¸ í…Œì´ë¸”
â”‚   â”œâ”€â”€ create_alerts_table.sql      # Day 6: ì•Œë¦¼ í…Œì´ë¸”
â”‚   â””â”€â”€ create_ab_test_tables.sql    # Day 7: A/B Test í…Œì´ë¸” âœ¨
â”‚
â””â”€â”€ dashboards/                      # Day 8 (ë‚´ì¼): Superset
```

------

## ğŸ“š ì°¸ê³  ìë£Œ

### A/B Testing ì´ë¡ 

- [Evan Miller's A/B Testing Guide](https://www.evanmiller.org/ab-testing/)
- [Optimizely Stats Engine](https://www.optimizely.com/optimization-glossary/statistical-significance/)
- [Google's Experiments Guide](https://support.google.com/analytics/answer/1745147)

### Chi-square ê²€ì •

- [SciPy chi2_contingency](https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.chi2_contingency.html)
- [Khan Academy: Chi-square Test](https://www.khanacademy.org/math/statistics-probability/inference-categorical-data-chi-square-tests)

### AdTech A/B Testing

- [Facebook's A/B Testing Platform](https://engineering.fb.com/2017/06/27/core-data/facebook-s-a-b-testing-platform/)
- [Airbnb's Experimentation Platform](https://medium.com/airbnb-engineering/experiments-at-airbnb-e2db3abf39e7)

------

## ğŸ‰ ë§ˆë¬´ë¦¬

Day 7ì—ì„œëŠ” **í†µê³„ì ìœ¼ë¡œ ê²€ì¦ëœ A/B Testing í”„ë ˆì„ì›Œí¬**ë¥¼ ì™„ì„±í–ˆìŠµë‹ˆë‹¤.

**í•µì‹¬ ì„±ê³¼:**

- âœ… ì‹¤ì‹œê°„ Chi-square ê²€ì •
- âœ… 96.6% ì‹ ë¢°ë„ë¡œ ìŠ¹ì íŒì •
- âœ… 36% CTR ê°œì„  ê²€ì¦
- âœ… FastAPIë¡œ ì¦‰ì‹œ ì¡°íšŒ (1.48ms)

**8ì£¼ í”„ë¡œì íŠ¸ ì§„í–‰ë¥ :**

- Day 1-3: ë°ì´í„° íŒŒì´í”„ë¼ì¸ âœ…
- Day 4-5: ì„±ëŠ¥ ìµœì í™” (72ë°°) âœ…
- Day 6: ì‹¤ì‹œê°„ ì´ìƒ íƒì§€ âœ…
- Day 7: A/B Testing âœ…
- **Day 8: ìµœì¢… ì •ë¦¬ + ëŒ€ì‹œë³´ë“œ** (ë‚´ì¼!)

------

**ë‹¤ìŒ ê¸€**: [Day 8: Superset ëŒ€ì‹œë³´ë“œ & í”„ë¡œì íŠ¸ ë§ˆë¬´ë¦¬](#)

**GitHub Repository**: [adtech-realtime-pipeline](https://github.com/yourusername/adtech-realtime-pipeline)

------

*ì´ ê¸€ì´ ë„ì›€ì´ ë˜ì—ˆë‹¤ë©´ â­ï¸ ìŠ¤íƒ€ì™€ ğŸ‘ ê³µìœ  ë¶€íƒë“œë¦½ë‹ˆë‹¤!*



